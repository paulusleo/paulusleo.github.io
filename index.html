<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Celengan Pro - Leo & Vanessa Savings Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#ec4899',
                        dark: '#1e293b',
                    }
                }
            }
        }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        .glass-dark {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .animate-slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .online-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .gradient-border {
            position: relative;
            border-radius: 1rem;
            padding: 2px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-border-content {
            background: white;
            border-radius: 0.9rem;
        }
        
        .hover-scale {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-scale:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .stat-card {
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .stat-card:hover::before {
            opacity: 1;
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
    
    <!-- LOGIN SECTION -->
    <div id="loginSection" class="min-h-screen flex items-center justify-center p-4 relative overflow-hidden">
        <!-- Animated Background Elements -->
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute w-96 h-96 bg-indigo-500/20 rounded-full blur-3xl -top-48 -left-48 animate-pulse"></div>
            <div class="absolute w-96 h-96 bg-pink-500/20 rounded-full blur-3xl -bottom-48 -right-48 animate-pulse" style="animation-delay: 1s;"></div>
            <div class="absolute w-72 h-72 bg-purple-500/20 rounded-full blur-3xl top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 animate-pulse" style="animation-delay: 2s;"></div>
        </div>
        
        <div class="glass-effect rounded-3xl p-12 max-w-md w-full shadow-2xl animate-fade-in relative z-10 border border-white/20">
            <div class="text-center mb-10">
                <div class="bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 w-24 h-24 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-2xl floating">
                    <i class="fas fa-piggy-bank text-white text-5xl"></i>
                </div>
                <h1 class="text-4xl font-black text-gray-800 mb-3 bg-gradient-to-r from-indigo-600 to-pink-600 bg-clip-text text-transparent">
                    Celengan Pro
                </h1>
                <p class="text-gray-600 text-lg font-medium">Sistem Tabungan Leo & Vanessa</p>
                <div class="mt-4 flex items-center justify-center space-x-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full online-pulse"></div>
                    <span class="text-sm text-gray-500 font-medium">Real-time Sync Active</span>
                </div>
            </div>

            <button onclick="loginWithGoogle()" 
                class="w-full bg-white border-2 border-gray-300 text-gray-700 font-bold py-5 px-6 rounded-2xl hover:bg-gray-50 hover:border-gray-400 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center space-x-3 mb-6 group">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="w-7 h-7 group-hover:scale-110 transition-transform" alt="Google">
                <span class="text-lg">Login dengan Google</span>
            </button>

            <div class="mt-8 pt-8 border-t border-gray-200">
                <div class="flex items-center justify-center space-x-4 text-gray-400 text-sm">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-shield-alt"></i>
                        <span>Secure</span>
                    </div>
                    <div class="w-1 h-1 bg-gray-400 rounded-full"></div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-cloud"></i>
                        <span>Cloud Backup</span>
                    </div>
                    <div class="w-1 h-1 bg-gray-400 rounded-full"></div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-lock"></i>
                        <span>Encrypted</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="mainApp" class="hidden">
        <!-- Navigation -->
        <nav class="glass-effect border-b border-white/10 sticky top-0 z-50 shadow-lg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-20">
                    <div class="flex items-center space-x-4">
                        <div class="bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-3 rounded-2xl shadow-lg">
                            <i class="fas fa-piggy-bank text-white text-2xl"></i>
                        </div>
                        <div>
                            <h1 class="text-2xl font-black text-gray-800">Celengan Pro</h1>
                            <p class="text-sm text-gray-500 flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2 online-pulse"></span>
                                <span class="font-semibold">Logged in as</span>
                                <span id="userName" class="ml-1 text-indigo-600 font-bold"></span>
                            </p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="hidden md:flex items-center space-x-2 bg-green-100 rounded-full px-5 py-2.5 border border-green-200">
                            <i class="fas fa-wifi text-green-600 text-lg"></i>
                            <span class="text-sm font-bold text-green-700">Online</span>
                        </div>
                        <div class="hidden md:flex items-center space-x-3">
                            <img id="userAvatar" class="w-12 h-12 rounded-full border-3 border-indigo-600 shadow-lg" alt="User">
                            <span class="text-sm font-semibold text-gray-700" id="userEmail"></span>
                        </div>
                        <button onclick="logout()" 
                            class="bg-gradient-to-r from-red-600 to-red-700 text-white font-bold py-3 px-6 rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center space-x-2">
                            <i class="fas fa-sign-out-alt"></i>
                            <span class="hidden md:inline">Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                <!-- Total Card -->
                <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in hover-scale stat-card">
                    <div class="flex items-center justify-between mb-5">
                        <div class="bg-gradient-to-br from-blue-500 to-cyan-500 p-4 rounded-2xl shadow-xl">
                            <i class="fas fa-wallet text-white text-3xl"></i>
                        </div>
                        <span class="text-xs font-black text-blue-600 bg-blue-100 px-4 py-2 rounded-full border border-blue-200">TOTAL</span>
                    </div>
                    <h3 class="text-gray-600 text-sm font-bold mb-2 uppercase tracking-wide">Total Keseluruhan</h3>
                    <p class="text-4xl font-black text-gray-800 mb-4" id="totalAll">Rp 0</p>
                    <div class="flex items-center text-sm pt-3 border-t border-gray-200">
                        <i class="fas fa-chart-line text-green-500 mr-2 text-lg"></i>
                        <span class="text-gray-600 font-semibold" id="totalEntries">0 transaksi</span>
                    </div>
                </div>

                <!-- Leo Card -->
                <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in hover-scale stat-card" style="animation-delay: 0.1s">
                    <div class="flex items-center justify-between mb-5">
                        <div class="bg-gradient-to-br from-indigo-500 to-purple-600 p-4 rounded-2xl shadow-xl">
                            <i class="fas fa-user-tie text-white text-3xl"></i>
                        </div>
                        <span class="text-xs font-black text-indigo-600 bg-indigo-100 px-4 py-2 rounded-full border border-indigo-200">LEO</span>
                    </div>
                    <h3 class="text-gray-600 text-sm font-bold mb-2 uppercase tracking-wide">Total Leo</h3>
                    <p class="text-4xl font-black bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-4" id="totalLeo">Rp 0</p>
                    <div class="flex items-center text-sm pt-3 border-t border-gray-200">
                        <i class="fas fa-arrow-up text-green-500 mr-2 text-lg"></i>
                        <span class="text-gray-600 font-semibold" id="leoCount">0 transaksi</span>
                    </div>
                </div>

                <!-- Vanessa Card -->
                <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in hover-scale stat-card" style="animation-delay: 0.2s">
                    <div class="flex items-center justify-between mb-5">
                        <div class="bg-gradient-to-br from-pink-500 to-rose-600 p-4 rounded-2xl shadow-xl">
                            <i class="fas fa-user text-white text-3xl"></i>
                        </div>
                        <span class="text-xs font-black text-pink-600 bg-pink-100 px-4 py-2 rounded-full border border-pink-200">VANESSA</span>
                    </div>
                    <h3 class="text-gray-600 text-sm font-bold mb-2 uppercase tracking-wide">Total Vanessa</h3>
                    <p class="text-4xl font-black bg-gradient-to-r from-pink-600 to-rose-600 bg-clip-text text-transparent mb-4" id="totalVanessa">Rp 0</p>
                    <div class="flex items-center text-sm pt-3 border-t border-gray-200">
                        <i class="fas fa-arrow-up text-green-500 mr-2 text-lg"></i>
                        <span class="text-gray-600 font-semibold" id="vanessaCount">0 transaksi</span>
                    </div>
                </div>

                <!-- Target Card -->
                <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in hover-scale stat-card" style="animation-delay: 0.3s">
                    <div class="flex items-center justify-between mb-5">
                        <div class="bg-gradient-to-br from-emerald-500 to-teal-600 p-4 rounded-2xl shadow-xl">
                            <i class="fas fa-bullseye text-white text-3xl"></i>
                        </div>
                        <span class="text-xs font-black text-emerald-600 bg-emerald-100 px-4 py-2 rounded-full border border-emerald-200">TARGET</span>
                    </div>
                    <h3 class="text-gray-600 text-sm font-bold mb-2 uppercase tracking-wide">Progress Target</h3>
                    <p class="text-4xl font-black text-gray-800 mb-4" id="targetProgress">0%</p>
                    <div class="pt-3 border-t border-gray-200">
                        <div class="w-full bg-gray-200 rounded-full h-3 shadow-inner">
                            <div class="bg-gradient-to-r from-emerald-500 to-teal-500 h-3 rounded-full transition-all duration-1000 shadow-lg" id="progressBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Form Section -->
                <div class="lg:col-span-1 space-y-6">
                    
                    <!-- Input Form -->
                    <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in">
                        <div class="flex items-center mb-8">
                            <div class="bg-gradient-to-br from-indigo-600 to-pink-600 p-3 rounded-xl mr-4 shadow-lg">
                                <i class="fas fa-plus text-white text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-black text-gray-800">Tambah Tabungan</h2>
                        </div>
                        
                        <form id="celenganForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-black text-gray-700 mb-3 uppercase tracking-wide">
                                    <i class="fas fa-user mr-2 text-indigo-600"></i>Nama
                                </label>
                                <div class="grid grid-cols-2 gap-4">
                                    <label class="relative cursor-pointer">
                                        <input type="radio" name="person" value="Leo" required class="peer sr-only">
                                        <div class="peer-checked:border-indigo-600 peer-checked:bg-gradient-to-br peer-checked:from-indigo-50 peer-checked:to-indigo-100 border-3 border-gray-200 rounded-2xl p-6 transition-all duration-300 hover:border-indigo-300 hover:shadow-lg">
                                            <div class="flex flex-col items-center">
                                                <i class="fas fa-user-tie text-indigo-600 text-4xl mb-3"></i>
                                                <p class="text-center font-black text-gray-800">Leo</p>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="relative cursor-pointer">
                                        <input type="radio" name="person" value="Vanessa" required class="peer sr-only">
                                        <div class="peer-checked:border-pink-600 peer-checked:bg-gradient-to-br peer-checked:from-pink-50 peer-checked:to-pink-100 border-3 border-gray-200 rounded-2xl p-6 transition-all duration-300 hover:border-pink-300 hover:shadow-lg">
                                            <div class="flex flex-col items-center">
                                                <i class="fas fa-user text-pink-600 text-4xl mb-3"></i>
                                                <p class="text-center font-black text-gray-800">Vanessa</p>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label for="amount" class="block text-sm font-black text-gray-700 mb-3 uppercase tracking-wide">
                                    <i class="fas fa-money-bill-wave mr-2 text-green-600"></i>Jumlah
                                </label>
                                <div class="relative">
                                    <span class="absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-500 font-black text-lg">Rp</span>
                                    <input type="number" id="amount" required min="0" step="1000" 
                                        class="w-full pl-14 pr-5 py-4 border-3 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all duration-300 font-bold text-lg"
                                        placeholder="50.000">
                                </div>
                            </div>

                            <div>
                                <label for="date" class="block text-sm font-black text-gray-700 mb-3 uppercase tracking-wide">
                                    <i class="fas fa-calendar mr-2 text-blue-600"></i>Tanggal
                                </label>
                                <input type="date" id="date" required 
                                    class="w-full px-5 py-4 border-3 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all duration-300 font-semibold">
                            </div>

                            <div>
                                <label for="category" class="block text-sm font-black text-gray-700 mb-3 uppercase tracking-wide">
                                    <i class="fas fa-tags mr-2 text-purple-600"></i>Kategori
                                </label>
                                <select id="category" 
                                    class="w-full px-5 py-4 border-3 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all duration-300 font-semibold text-gray-700">
                                    <option value="Gaji">üíº Gaji</option>
                                    <option value="Bonus">üéÅ Bonus</option>
                                    <option value="Tabungan Rutin">üîÑ Tabungan Rutin</option>
                                    <option value="Hadiah">üéâ Hadiah</option>
                                    <option value="Lainnya">üìù Lainnya</option>
                                </select>
                            </div>

                            <div>
                                <label for="note" class="block text-sm font-black text-gray-700 mb-3 uppercase tracking-wide">
                                    <i class="fas fa-sticky-note mr-2 text-yellow-600"></i>Keterangan
                                </label>
                                <textarea id="note" rows="3"
                                    class="w-full px-5 py-4 border-3 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all duration-300 resize-none font-medium"
                                    placeholder="Catatan tambahan..."></textarea>
                            </div>

                            <button type="submit" 
                                class="w-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 text-white font-black py-5 px-6 rounded-2xl hover:from-indigo-700 hover:via-purple-700 hover:to-pink-700 transform hover:scale-105 transition-all duration-300 shadow-2xl hover:shadow-3xl flex items-center justify-center space-x-3 text-lg">
                                <i class="fas fa-cloud-upload-alt text-2xl"></i>
                                <span>Simpan ke Cloud</span>
                            </button>
                        </form>
                    </div>

                    <!-- Target Settings -->
                    <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in">
                        <div class="flex items-center mb-6">
                            <div class="bg-gradient-to-br from-emerald-600 to-teal-600 p-3 rounded-xl mr-4 shadow-lg">
                                <i class="fas fa-flag-checkered text-white text-xl"></i>
                            </div>
                            <h2 class="text-xl font-black text-gray-800">Target Tabungan</h2>
                        </div>
                        <div class="space-y-4">
                            <div class="relative">
                                <span class="absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-500 font-black text-lg">Rp</span>
                                <input type="number" id="targetAmount" value="10000000" min="0" step="100000"
                                    class="w-full pl-14 pr-5 py-4 border-3 border-gray-200 rounded-2xl focus:ring-4 focus:ring-emerald-500/50 focus:border-emerald-500 transition-all duration-300 font-bold text-lg"
                                    onchange="updateTarget()">
                            </div>
                            <div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-5 border-2 border-emerald-200">
                                <p class="text-sm text-gray-600 text-center font-semibold mb-2">Target Anda:</p>
                                <p class="font-black text-emerald-600 text-2xl text-center" id="targetDisplay">Rp 10.000.000</p>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Table Section -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Filter Buttons -->
                    <div class="glass-effect rounded-3xl p-6 border border-white/20 shadow-2xl animate-fade-in">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                            <div class="flex items-center space-x-3">
                                <button onclick="filterData('all')" id="filterAll" 
                                    class="filter-btn px-6 py-3 rounded-xl font-black transition-all duration-300 bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
                                    <i class="fas fa-list mr-2"></i>Semua
                                </button>
                                <button onclick="filterData('Leo')" id="filterLeo" 
                                    class="filter-btn px-6 py-3 rounded-xl font-black transition-all duration-300 bg-gray-200 text-gray-700 hover:bg-indigo-100 hover:text-indigo-700 shadow-md">
                                    <i class="fas fa-user-tie mr-2"></i>Leo
                                </button>
                                <button onclick="filterData('Vanessa')" id="filterVanessa" 
                                    class="filter-btn px-6 py-3 rounded-xl font-black transition-all duration-300 bg-gray-200 text-gray-700 hover:bg-pink-100 hover:text-pink-700 shadow-md">
                                    <i class="fas fa-user mr-2"></i>Vanessa
                                </button>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button onclick="exportToExcel()" 
                                    class="bg-gradient-to-r from-green-600 to-emerald-600 text-white font-black py-3 px-6 rounded-xl hover:from-green-700 hover:to-emerald-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center space-x-2">
                                    <i class="fas fa-file-excel text-lg"></i>
                                    <span>Export Excel</span>
                                </button>
                                <button onclick="clearAllData()" 
                                    class="bg-gradient-to-r from-red-600 to-rose-600 text-white font-black py-3 px-6 rounded-xl hover:from-red-700 hover:to-rose-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center space-x-2">
                                    <i class="fas fa-trash text-lg"></i>
                                    <span class="hidden md:inline">Clear All</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="glass-effect rounded-3xl border border-white/20 shadow-2xl overflow-hidden animate-fade-in">
                        <div class="p-8 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="bg-gradient-to-br from-indigo-600 to-pink-600 p-3 rounded-xl mr-4 shadow-lg">
                                        <i class="fas fa-history text-white text-xl"></i>
                                    </div>
                                    <h2 class="text-2xl font-black text-gray-800">Riwayat Transaksi</h2>
                                </div>
                                <input type="text" id="searchInput" onkeyup="searchTable()" 
                                    placeholder="üîç Cari transaksi..."
                                    class="px-5 py-3 border-3 border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all duration-300 font-semibold">
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto custom-scrollbar">
                            <table class="w-full" id="savingsTable">
                                <thead class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 text-white">
                                    <tr>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">No</th>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">Tanggal</th>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">Nama</th>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">Kategori</th>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">Jumlah</th>
                                        <th class="px-6 py-5 text-left text-sm font-black uppercase tracking-wider">Keterangan</th>
                                        <th class="px-6 py-5 text-center text-sm font-black uppercase tracking-wider">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody" class="divide-y divide-gray-200 bg-white">
                                    <tr>
                                        <td colspan="7" class="px-6 py-16 text-center">
                                            <div class="shimmer w-full h-8 rounded mb-4"></div>
                                            <div class="shimmer w-3/4 h-8 rounded mx-auto"></div>
                                            <p class="text-gray-500 font-semibold mt-4">Memuat data...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="p-6 bg-gradient-to-r from-gray-50 to-gray-100 border-t border-gray-200 flex justify-between items-center">
                            <p class="text-sm text-gray-600 font-semibold">
                                Menampilkan <span class="font-black text-indigo-600" id="showingCount">0</span> dari <span class="font-black text-gray-800" id="totalCount">0</span> transaksi
                            </p>
                            <div class="flex items-center space-x-2 text-xs text-gray-500">
                                <i class="fas fa-sync-alt animate-spin"></i>
                                <span class="font-semibold">Auto-sync aktif</span>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Summary -->
                    <div class="glass-effect rounded-3xl p-8 border border-white/20 shadow-2xl animate-fade-in">
                        <div class="flex items-center mb-8">
                            <div class="bg-gradient-to-br from-blue-600 to-cyan-600 p-3 rounded-xl mr-4 shadow-lg">
                                <i class="fas fa-chart-bar text-white text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-black text-gray-800">Ringkasan Bulan Ini</h2>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-6 border-3 border-indigo-200 shadow-lg hover-scale">
                                <p class="text-sm text-gray-600 mb-2 font-black uppercase tracking-wide">Total Bulan Ini</p>
                                <p class="text-3xl font-black text-indigo-600" id="monthlyTotal">Rp 0</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-6 border-3 border-green-200 shadow-lg hover-scale">
                                <p class="text-sm text-gray-600 mb-2 font-black uppercase tracking-wide">Transaksi Bulan Ini</p>
                                <p class="text-3xl font-black text-green-600" id="monthlyCount">0</p>
                            </div>
                            <div class="bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl p-6 border-3 border-orange-200 shadow-lg hover-scale">
                                <p class="text-sm text-gray-600 mb-2 font-black uppercase tracking-wide">Rata-rata</p>
                                <p class="text-3xl font-black text-orange-600" id="monthlyAvg">Rp 0</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-8 right-8 bg-white rounded-2xl shadow-2xl p-6 transform translate-y-32 transition-all duration-500 border-l-4 border-green-500 hidden z-50 max-w-md">
        <div class="flex items-center space-x-4">
            <div class="bg-green-100 p-3 rounded-xl">
                <i class="fas fa-check-circle text-green-500 text-3xl"></i>
            </div>
            <div>
                <p class="font-black text-gray-800 text-lg" id="toastTitle">Success!</p>
                <p class="text-sm text-gray-600 font-semibold" id="toastMessage">Data berhasil disimpan</p>
            </div>
        </div>
    </div>

    <!-- Firebase & App Scripts -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, push, set, onValue, remove } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAdF4TYoZvdsATfhYONwpCVeGazwUDMTDc",
            authDomain: "celengan-app-2b350.firebaseapp.com",
            databaseURL: "https://celengan-app-2b350-default-rtdb.firebaseio.com",
            projectId: "celengan-app-2b350",
            storageBucket: "celengan-app-2b350.firebasestorage.app",
            messagingSenderId: "770592004139",
            appId: "1:770592004139:web:1209975f8e2e38c5e6326e",
            measurementId: "G-C69YSWKW8J"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        window.firebaseDB = { database, auth, provider, ref, push, set, onValue, remove, signInWithPopup, signOut };
        window.savingsData = [];
        window.currentFilter = 'all';
        window.targetAmount = 10000000;

        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.currentUser = user;
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                document.getElementById('userName').textContent = user.displayName || user.email.split('@')[0];
                document.getElementById('userEmail').textContent = user.email;
                
                if (user.photoURL) {
                    document.getElementById('userAvatar').src = user.photoURL;
                } else {
                    document.getElementById('userAvatar').src = `https://ui-avatars.com/api/?name=${user.email}&background=6366f1&color=fff`;
                }
                
                const savingsRef = ref(database, 'savings');
                onValue(savingsRef, (snapshot) => {
                    window.savingsData = [];
                    const data = snapshot.val();
                    
                    if (data) {
                        Object.keys(data).forEach(key => {
                            window.savingsData.push({
                                firebaseId: key,
                                ...data[key]
                            });
                        });
                        window.savingsData.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    }
                    
                    window.renderTable();
                    window.updateStatistics();
                });
            } else {
                window.currentUser = null;
                document.getElementById('loginSection').classList.remove('hidden');
                document.getElementById('mainApp').classList.add('hidden');
            }
        });
    </script>

    <script>
        window.loginWithGoogle = async function() {
            try {
                const result = await window.firebaseDB.signInWithPopup(
                    window.firebaseDB.auth,
                    window.firebaseDB.provider
                );
                showToast('Login Berhasil!', `Selamat datang ${result.user.displayName || result.user.email}! üéâ`);
            } catch (error) {
                console.error('Login error:', error);
                alert('Error login: ' + error.message);
            }
        };

        window.logout = async function() {
            if (confirm('Yakin ingin logout?')) {
                try {
                    await window.firebaseDB.signOut(window.firebaseDB.auth);
                    showToast('Logout Berhasil', 'Sampai jumpa! üëã');
                } catch (error) {
                    console.error('Logout error:', error);
                }
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('date').valueAsDate = new Date();
            updateTarget();
        });

        document.getElementById('celenganForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const person = document.querySelector('input[name="person"]:checked').value;
            const amount = parseInt(document.getElementById('amount').value);
            const date = document.getElementById('date').value;
            const category = document.getElementById('category').value;
            const note = document.getElementById('note').value || '-';

            const newData = {
                person: person,
                amount: amount,
                date: date,
                category: category,
                note: note,
                timestamp: new Date().toISOString(),
                createdBy: window.currentUser.email
            };

            try {
                const savingsRef = window.firebaseDB.ref(window.firebaseDB.database, 'savings');
                const newRef = window.firebaseDB.push(savingsRef);
                await window.firebaseDB.set(newRef, newData);
                
                this.reset();
                document.getElementById('date').valueAsDate = new Date();
                document.querySelectorAll('input[name="person"]').forEach(radio => radio.checked = false);
                
                showToast('Berhasil Disimpan!', `Tabungan ${person} sebesar Rp ${amount.toLocaleString('id-ID')} telah tersimpan di cloud! ‚òÅÔ∏è‚ú®`);
            } catch (error) {
                console.error('Error saving data:', error);
                alert('Gagal menyimpan data: ' + error.message);
            }
        });

        window.renderTable = function() {
            const tableBody = document.getElementById('tableBody');
            let filteredData = window.savingsData;

            if (window.currentFilter !== 'all') {
                filteredData = window.savingsData.filter(item => item.person === window.currentFilter);
            }

            if (filteredData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-16 text-center">
                            <i class="fas fa-inbox text-gray-300 text-6xl mb-4"></i>
                            <p class="text-gray-500 font-bold text-lg">Tidak ada data</p>
                            <p class="text-gray-400 text-sm mt-2">Belum ada transaksi untuk ditampilkan</p>
                        </td>
                    </tr>
                `;
                document.getElementById('showingCount').textContent = '0';
                document.getElementById('totalCount').textContent = window.savingsData.length;
                return;
            }

            tableBody.innerHTML = filteredData.map((item, index) => `
                <tr class="hover:bg-gradient-to-r hover:from-indigo-50 hover:to-purple-50 transition-all duration-300 cursor-pointer border-b border-gray-100">
                    <td class="px-6 py-5 text-gray-700 font-black">${index + 1}</td>
                    <td class="px-6 py-5 text-gray-700 font-semibold">${formatDate(item.date)}</td>
                    <td class="px-6 py-5">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full ${item.person === 'Leo' ? 'bg-gradient-to-br from-indigo-100 to-indigo-200' : 'bg-gradient-to-br from-pink-100 to-pink-200'} flex items-center justify-center shadow-lg">
                                <i class="fas ${item.person === 'Leo' ? 'fa-user-tie text-indigo-600' : 'fa-user text-pink-600'} text-lg"></i>
                            </div>
                            <span class="font-black ${item.person === 'Leo' ? 'text-indigo-600' : 'text-pink-600'} text-lg">${item.person}</span>
                        </div>
                    </td>
                    <td class="px-6 py-5">
                        <span class="px-4 py-2 bg-gradient-to-r from-purple-100 to-purple-200 text-purple-700 rounded-full text-xs font-black uppercase tracking-wide shadow-md">${item.category}</span>
                    </td>
                    <td class="px-6 py-5 font-black text-green-600 text-lg">Rp ${item.amount.toLocaleString('id-ID')}</td>
                    <td class="px-6 py-5 text-gray-600 max-w-xs truncate font-semibold">${item.note}</td>
                    <td class="px-6 py-5 text-center">
                        <button onclick="deleteItem('${item.firebaseId}')" 
                            class="text-red-600 hover:bg-red-50 p-3 rounded-xl transition-all duration-300 hover:shadow-lg">
                            <i class="fas fa-trash text-lg"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            document.getElementById('showingCount').textContent = filteredData.length;
            document.getElementById('totalCount').textContent = window.savingsData.length;
        };

        window.updateStatistics = function() {
            const totalLeo = window.savingsData.filter(i => i.person === 'Leo').reduce((sum, i) => sum + i.amount, 0);
            const totalVanessa = window.savingsData.filter(i => i.person === 'Vanessa').reduce((sum, i) => sum + i.amount, 0);
            const totalAll = totalLeo + totalVanessa;

            const leoCount = window.savingsData.filter(i => i.person === 'Leo').length;
            const vanessaCount = window.savingsData.filter(i => i.person === 'Vanessa').length;

            document.getElementById('totalLeo').textContent = `Rp ${totalLeo.toLocaleString('id-ID')}`;
            document.getElementById('totalVanessa').textContent = `Rp ${totalVanessa.toLocaleString('id-ID')}`;
            document.getElementById('totalAll').textContent = `Rp ${totalAll.toLocaleString('id-ID')}`;
            
            document.getElementById('leoCount').textContent = `${leoCount} transaksi`;
            document.getElementById('vanessaCount').textContent = `${vanessaCount} transaksi`;
            document.getElementById('totalEntries').textContent = `${window.savingsData.length} transaksi`;

            const progress = Math.min((totalAll / window.targetAmount) * 100, 100);
            document.getElementById('targetProgress').textContent = `${progress.toFixed(1)}%`;
            document.getElementById('progressBar').style.width = `${progress}%`;

            updateMonthlySummary();
        };

        function updateMonthlySummary() {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            const monthlyData = window.savingsData.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate.getMonth() === currentMonth && itemDate.getFullYear() === currentYear;
            });

            const monthlyTotal = monthlyData.reduce((sum, item) => sum + item.amount, 0);
            const monthlyCount = monthlyData.length;
            const monthlyAvg = monthlyCount > 0 ? monthlyTotal / monthlyCount : 0;

            document.getElementById('monthlyTotal').textContent = `Rp ${monthlyTotal.toLocaleString('id-ID')}`;
            document.getElementById('monthlyCount').textContent = monthlyCount;
            document.getElementById('monthlyAvg').textContent = `Rp ${Math.round(monthlyAvg).toLocaleString('id-ID')}`;
        }

        window.filterData = function(filter) {
            window.currentFilter = filter;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-gradient-to-r', 'from-indigo-600', 'to-purple-600', 'text-white', 'shadow-lg');
                btn.classList.add('bg-gray-200', 'text-gray-700', 'shadow-md');
            });

            const activeBtn = document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}`);
            activeBtn.classList.remove('bg-gray-200', 'text-gray-700', 'shadow-md');
            activeBtn.classList.add('bg-gradient-to-r', 'from-indigo-600', 'to-purple-600', 'text-white', 'shadow-lg');

            window.renderTable();
        };

        window.searchTable = function() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#tableBody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(input) ? '' : 'none';
            });
        };

        window.deleteItem = async function(firebaseId) {
            if (confirm('‚ö†Ô∏è Yakin ingin menghapus transaksi ini?')) {
                try {
                    const itemRef = window.firebaseDB.ref(window.firebaseDB.database, `savings/${firebaseId}`);
                    await window.firebaseDB.remove(itemRef);
                    showToast('Terhapus!', 'Transaksi berhasil dihapus üóëÔ∏è');
                } catch (error) {
                    console.error('Error deleting data:', error);
                    alert('Gagal menghapus data: ' + error.message);
                }
            }
        };

        window.clearAllData = async function() {
            if (confirm('‚ö†Ô∏è Yakin ingin menghapus SEMUA data? Tindakan ini tidak dapat dibatalkan!')) {
                if (confirm('‚ö†Ô∏è Konfirmasi sekali lagi: Hapus semua data?')) {
                    try {
                        const savingsRef = window.firebaseDB.ref(window.firebaseDB.database, 'savings');
                        await window.firebaseDB.set(savingsRef, null);
                        showToast('Data Dibersihkan!', 'Semua data telah dihapus üßπ');
                    } catch (error) {
                        console.error('Error clearing data:', error);
                        alert('Gagal menghapus data: ' + error.message);
                    }
                }
            }
        };

        window.updateTarget = function() {
            window.targetAmount = parseInt(document.getElementById('targetAmount').value);
            document.getElementById('targetDisplay').textContent = `Rp ${window.targetAmount.toLocaleString('id-ID')}`;
            window.updateStatistics();
        };

        window.exportToExcel = function() {
            if (window.savingsData.length === 0) {
                alert('‚ö†Ô∏è Belum ada data untuk diexport!');
                return;
            }

            const excelData = [
                ["LAPORAN CELENGAN LEO & VANESSA"],
                [`Diekspor pada: ${new Date().toLocaleString('id-ID')}`],
                [],
                ["No", "Tanggal", "Nama", "Kategori", "Jumlah (Rp)", "Keterangan"]
            ];

            window.savingsData.forEach((item, index) => {
                excelData.push([
                    index + 1,
                    item.date,
                    item.person,
                    item.category,
                    item.amount,
                    item.note
                ]);
            });

            excelData.push([]);
            excelData.push(["RINGKASAN"]);
            excelData.push(["Total Leo", "", "", "", window.savingsData.filter(i => i.person === 'Leo').reduce((s, i) => s + i.amount, 0)]);
            excelData.push(["Total Vanessa", "", "", "", window.savingsData.filter(i => i.person === 'Vanessa').reduce((s, i) => s + i.amount, 0)]);
            excelData.push(["TOTAL KESELURUHAN", "", "", "", window.savingsData.reduce((s, i) => s + i.amount, 0)]);

            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Celengan");

            const fileName = `Celengan_Leo_Vanessa_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);

            showToast('Export Berhasil!', `File ${fileName} telah didownload üì•`);
        };

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', { 
                day: '2-digit', 
                month: 'short', 
                year: 'numeric' 
            });
        }

        function showToast(title, message) {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');

            toastTitle.textContent = title;
            toastMessage.textContent = message;

            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.style.transform = 'translateY(0)';
            }, 100);

            setTimeout(() => {
                toast.style.transform = 'translateY(200px)';
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 500);
            }, 4000);
        }
    </script>
</body>
</html>
